<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SharkHub Post</title>
<link rel="icon" type="image/png" href="img/fivecon.png">
<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }
body {
  background-color: #121212;
  color: #fff;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #1e1e1e;
  padding: 10px 20px;
  flex-wrap: wrap;
}

#logoHeader {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

#logoHeader img {
  width: 150px;
  height: auto;
}

#telefoneBox {
  background: #2a2a2a;
  border: none;
  color: #fff;
  padding: 8px;
  border-radius: 8px;
  width: 160px;
}

header input[type="text"] {
  background: #2a2a2a;
  border: none;
  padding: 8px;
  border-radius: 8px;
  color: #fff;
}

header button {
  background: #94CF4F;
  border: none;
  color: white;
  padding: 10px 15px;
  border-radius: 8px;
  cursor: pointer;
  margin: 5px;
}

header button:hover { background: #80b63f; }

main {
  flex: 1;
  padding: 20px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

.card {
  background: #1e1e1e;
  border-radius: 10px;
  padding: 15px;
  position: relative;
  transition: transform 0.2s;
}

.card h4 { color: #94CF4F; }

.card:hover { transform: scale(1.02); background: #2a2a2a; }

.edit-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  background: transparent;
  border: none;
  color: #aaa;
  cursor: pointer;
  font-size: 18px;
  display: none;
}

.card:hover .edit-btn { display: block; }

.card input[type="checkbox"] {
  position: absolute;
  top: 10px;
  left: 10px;
  transform: scale(1.3);
  display: none;
}

.card.selected input[type="checkbox"] { display: block; }

.popup {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: #1e1e1e;
  padding: 20px;
  border-radius: 10px;
  width: 90%;
  max-width: 400px;
}

.popup-content input, .popup-content textarea {
  width: 100%;
  background: #2a2a2a;
  border: none;
  color: #fff;
  padding: 8px;
  border-radius: 6px;
  margin-top: 8px;
}

.popup-content button {
  background: #94CF4F;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 8px;
  cursor: pointer;
  margin: 8px 5px 0 0;
}

footer {
  background: #1e1e1e;
  padding: 10px;
  text-align: center;
  color: #888;
  font-size: 14px;
}

.notificacao {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #94CF4F;
  color: #fff;
  padding: 10px 20px;
  border-radius: 8px;
  opacity: 0;
  transition: all 0.3s ease;
  z-index: 2000;
}

@media (max-width: 600px) {
  header input { width: 100%; margin-top: 10px; }
}

/* Tema claro */
body.light { background: #f0f0f0; color: #000; }
body.light header { background: #e0e0e0; }
body.light main { }
body.light .card { background: #ffffff; color: #000; }
body.light .card h4 { color: #94CF4F; }
body.light header input[type="text"], body.light #telefoneBox, body.light .popup-content input, body.light .popup-content textarea { background: #e8e8e8; color: #000; }
body.light .popup-content { background: #f0f0f0; color: #000; }
</style>
</head>
<body>
<header>
  <div id="logoHeader">
    <img src="img/Design sem nome.png" alt="Logo Site">
    <input type="text" id="telefoneBox" value="(00) 0000-0000" />
  </div>
  <input type="text" id="search" placeholder="Pesquisar...">
  <div>
    <button id="addBtn">Adicionar</button>
    <button id="draftBtn">Rascunho</button>
    <button id="selectBtn">Selecionar</button>
    <button id="deleteBtn" style="display:none;">üóëÔ∏è Excluir</button>
    <button id="configBtn">Configura√ß√µes</button>
  </div>
</header>

<main id="cardsContainer"></main>

<footer>SharkHub Post ¬© 2025</footer>

<!-- POPUPS -->
<div class="popup" id="popupAdd">
  <div class="popup-content">
    <h3 id="popupTitle">Nova Descri√ß√£o</h3>
    <input type="text" id="titulo" placeholder="T√≠tulo">
    <input type="text" id="km" placeholder="Quilometragem">
    <input type="text" id="valor" placeholder="Valor">
    <textarea id="descricao" placeholder="Descri√ß√£o..."></textarea>
    <button id="salvarBtn">Salvar</button>
    <button id="salvarRascunhoBtn">Rascunho</button>
    <button id="cancelarBtn">Cancelar</button>
  </div>
</div>

<div class="popup" id="popupConfig">
  <div class="popup-content">
    <h3>Configura√ß√µes</h3>
    <button onclick="alternarTema()">Alternar Tema</button>
    <button onclick="abrirPopupBackup()">üíæ Backup</button>
    <button onclick="fecharPopup('popupConfig')">Fechar</button>
  </div>
</div>

<div class="popup" id="popupBackup">
  <div class="popup-content">
    <h3>Backup / Importar-Exportar</h3>
    <p>Escolha o que deseja fazer:</p>
    <div style="display:flex;flex-direction:column;gap:10px;">
      <button onclick="exportarBackup()">‚¨áÔ∏è Exportar dados</button>
      <input type="file" id="inputBackup" style="display:none;" accept=".json" />
      <button onclick="document.getElementById('inputBackup').click()">‚¨ÜÔ∏è Importar dados</button>
      <button onclick="fecharPopup('popupBackup')">Fechar</button>
    </div>
  </div>
</div>

<div class="popup" id="popupRascunhos">
  <div class="popup-content">
    <h3>Rascunhos</h3>
    <div id="rascunhosContainer"></div>
    <button onclick="fecharPopup('popupRascunhos')">Fechar</button>
  </div>
</div>

<div id="notificacao" class="notificacao"></div>

<script>
let descricoes = JSON.parse(localStorage.getItem('descricoes') || '[]');
let rascunhos = JSON.parse(localStorage.getItem('rascunhos') || '[]');
let numero = localStorage.getItem('numero') || "(00) 0000-0000";
let editIndex = null;
let editRascunhoIndex = null;
let modoSelecao = false;

const telefoneBox = document.getElementById('telefoneBox');
const cardsContainer = document.getElementById('cardsContainer');

telefoneBox.value = numero;
telefoneBox.addEventListener("input", () => {
  numero = telefoneBox.value;
  localStorage.setItem('numero', numero);
});

function render() {
  cardsContainer.innerHTML = "";
  const search = document.getElementById('search').value.toLowerCase();
  descricoes.filter(d => d.titulo.toLowerCase().includes(search)).forEach((d, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    if (modoSelecao) card.classList.add('selected');

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.dataset.index = i;

    const editBtn = document.createElement('button');
    editBtn.className = 'edit-btn';
    editBtn.innerHTML = '‚úèÔ∏è';
    editBtn.onclick = (e) => { e.stopPropagation(); editarDescricao(i); };

    card.innerHTML = `<h4>${d.titulo}</h4><p>KM: ${d.km}</p><p>Valor: ${d.valor}</p>`;
    card.prepend(checkbox);
    card.appendChild(editBtn);

    card.onclick = () => {
      if (modoSelecao) checkbox.checked = !checkbox.checked;
      else {
        const texto = `${d.descricao}\nüì≤ ${numero}`;
        navigator.clipboard.writeText(texto);
        showNotification("Descri√ß√£o copiada com telefone!");
      }
    };

    cardsContainer.appendChild(card);
  });
}

function salvar() {
  localStorage.setItem('descricoes', JSON.stringify(descricoes));
  localStorage.setItem('numero', numero);
  render();
}

function abrirPopup(id) { document.getElementById(id).style.display = 'flex'; }
function fecharPopup(id) { document.getElementById(id).style.display = 'none'; }

document.getElementById('addBtn').onclick = () => {
  editIndex = null;
  titulo.value = km.value = valor.value = descricao.value = "";
  popupTitle.textContent = "Nova Descri√ß√£o";
  abrirPopup('popupAdd');
};

document.getElementById('salvarRascunhoBtn').onclick = () => {
  const t = titulo.value.trim();
  if (!t) return alert("Digite um t√≠tulo.");
  const r = { titulo: t, km: km.value, valor: valor.value, descricao: descricao.value };
  if(editRascunhoIndex!==null) rascunhos[editRascunhoIndex]=r;
  else rascunhos.push(r);
  localStorage.setItem('rascunhos', JSON.stringify(rascunhos));
  fecharPopup('popupAdd');
  showNotification("Rascunho salvo!");
};

document.getElementById('salvarBtn').onclick = () => {
  const t = titulo.value.trim();
  if (!t) return alert("Digite um t√≠tulo.");
  const d = { titulo: t, km: km.value, valor: valor.value, descricao: descricao.value };
  if (editIndex === null) descricoes.push(d);
  else descricoes[editIndex] = d;
  fecharPopup('popupAdd');
  salvar();
  showNotification("Descri√ß√£o salva!");
};

document.getElementById('cancelarBtn').onclick = () => fecharPopup('popupAdd');

function editarDescricao(i) {
  const d = descricoes[i];
  editIndex = i;
  titulo.value = d.titulo;
  km.value = d.km;
  valor.value = d.valor;
  descricao.value = d.descricao;
  popupTitle.textContent = "Editar Descri√ß√£o";
  abrirPopup('popupAdd');
}

selectBtn.onclick = () => {
  modoSelecao = !modoSelecao;
  deleteBtn.style.display = modoSelecao ? 'inline-block' : 'none';
  render();
};

deleteBtn.onclick = () => {
  const selecionados = document.querySelectorAll('.card input[type="checkbox"]:checked');
  if (selecionados.length === 0) return showNotification("Nenhum item selecionado.");
  // Exclus√£o pelo site
  const confirmBox = document.createElement('div');
  confirmBox.className = 'notificacao';
  confirmBox.innerHTML = 'Deseja excluir os itens selecionados? <button style="margin-left:10px;background:#FF4D4D;color:#fff;border:none;padding:3px 5px;border-radius:3px;cursor:pointer;">Sim</button> <button style="margin-left:5px;background:#888;color:#fff;border:none;padding:3px 5px;border-radius:3px;cursor:pointer;">N√£o</button>';
  document.body.appendChild(confirmBox);
  setTimeout(()=>confirmBox.style.opacity=1,10);

  confirmBox.querySelector('button:nth-child(1)').onclick = () => {
    const indices = Array.from(selecionados).map(cb => parseInt(cb.dataset.index));
    descricoes = descricoes.filter((_, i) => !indices.includes(i));
    salvar();
    confirmBox.remove();
    showNotification("Itens exclu√≠dos!");
  };
  confirmBox.querySelector('button:nth-child(2)').onclick = ()=>{ confirmBox.remove(); };
  setTimeout(()=>confirmBox.style.opacity=0,3000);
  setTimeout(()=>confirmBox.remove(),3500);
};

configBtn.onclick = () => abrirPopup('popupConfig');
draftBtn.onclick = () => abrirRascunhos();
search.addEventListener('input', render);

km.addEventListener("input", () => {
  km.value = km.value.replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ".");
});

valor.addEventListener("input", () => {
  let v = valor.value.replace(/\D/g, "");
  v = (v / 100).toFixed(2) + "";
  v = v.replace(".", ",");
  v = v.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  valor.value = v;
});

function alternarTema() {
  document.body.classList.toggle('light');
  showNotification(document.body.classList.contains('light') ? "Tema claro ativado" : "Tema escuro ativado");
}

function abrirPopupBackup() { abrirPopup('popupBackup'); }

function exportarBackup() {
  const data = { descricoes, numero, rascunhos };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "backup_sharkhub.json";
  a.click();
  URL.revokeObjectURL(a.href);
  showNotification("‚úÖ Backup exportado!");
}

document.getElementById("inputBackup").addEventListener("change", (event) => {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = (e) => {
    try {
      const data = JSON.parse(e.target.result);
      descricoes = data.descricoes || [];
      numero = data.numero || "(00) 0000-0000";
      rascunhos = data.rascunhos || [];
      telefoneBox.value = numero;
      salvar();
      showNotification("‚úÖ Backup importado!");
    } catch (err) { showNotification("‚ùå Erro: " + err.message); }
  };
  reader.readAsText(file);
});

function showNotification(msg) {
  const noti = document.getElementById('notificacao');
  noti.textContent = msg;
  noti.style.opacity = 1;
  setTimeout(()=>{ noti.style.opacity=0; },3000);
}

function abrirRascunhos() {
  fecharPopup('popupConfig');
  const container = document.getElementById('rascunhosContainer');
  container.innerHTML = "";
  rascunhos.forEach((r, i) => {
    const div = document.createElement('div');
    div.style.border = "1px solid #94CF4F";
    div.style.borderRadius = "6px";
    div.style.padding = "5px 35px 5px 5px";
    div.style.marginBottom = "5px";
    div.style.cursor = "pointer";
    div.style.position = "relative";
    div.innerHTML = `<strong>${r.titulo}</strong>`;

    const delBtn = document.createElement('button');
    delBtn.innerText = "üóëÔ∏è";
    delBtn.style.position = "absolute";
    delBtn.style.right = "5px";
    delBtn.style.top = "5px";
    delBtn.style.background = "transparent";
    delBtn.style.border = "none";
    delBtn.style.cursor = "pointer";
    delBtn.style.color = "#FF4D4D";
    delBtn.style.fontSize = "14px";

    delBtn.onclick = (e) => {
      e.stopPropagation();
      rascunhos.splice(i,1);
      localStorage.setItem('rascunhos', JSON.stringify(rascunhos));
      abrirRascunhos();
      showNotification("Rascunho exclu√≠do!");
    };

    div.appendChild(delBtn);
    div.onclick = () => {
      editRascunhoIndex = i;
      titulo.value = r.titulo;
      km.value = r.km || "";
      valor.value = r.valor || "";
      descricao.value = r.descricao || "";
      popupTitle.textContent = "Editar Rascunho";
      abrirPopup('popupAdd');
      fecharPopup('popupRascunhos');
    };

    container.appendChild(div);
  });
  abrirPopup('popupRascunhos');
}

window.onload = render;
</script>
</body>
</html>
